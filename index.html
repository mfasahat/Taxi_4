<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Basic Page Needs–– -->
    <meta charset="utf-8">
    <title>Full Streets, Empty Seats</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- FONT -->
    <link href="https://fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css">

    <!-- CSS -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/customize.css">
       <link rel="stylesheet" href="css/style2.css">


    <!-- D3 -->
    <script src="https://d3js.org/d3.v3.js"></script>
    <script type="text/javascript">
        var d3v3 = window.d3;
        window.d3 = null;
    </script>
    <script src="https://d3js.org/d3.v5.js"></script>
    
     <!-- Favicon -->
  <link rel="icon" type="image/png" href="img/Diagrams-Images/taxi-stop.png">

</head>

<style>

    body {
        font: 10px sans-serif;
    }

    .chart {
        background: #fff;
    }

    p {
        font: 12px helvetica;
    }


    .axis path, .axis line {
        fill: none;
        stroke: #000;
        stroke-width: 2px;
        shape-rendering: crispEdges;
    }

    button {
        position: absolute;
        right: 50px;
        top: 10px;
    }

</style>
    
    <body>

      <header>
       <div class="container one-bottom" style="margin-top: 50px">
    <div class="ten columns">
      <h2>Full Streets, Empty Seats</h2>
      <p>
       Mobility on Demand Systems: Data-Driven Analysis, Simulation, Visualization
       <br>
        ARCH 6306/6050, DSBA 6010, ITIS 8010/6010: Wednesdays 6pm-8:30pm, Taught Online
        <br>
        Team: Davis Millarrd, Connor Burdick, Aaron Perrill, Mohammad Fasahat
        <br>
        Dr. Dimitris Papanikolaou | dpapanik@uncc.edu | Urban Synergetics Lab | https://urbansynergeticslab.net
      </p>
    </div>
    <div class="two columns">
      <a href="https://urbansynergeticslab.net/"><img class="scale-with-grid" src="img/LabLogo_dark_cropped.png"></a>
    </div>
  </div>

        <h1 class="big-title translate" data-speed="0.3">Full Streets, Empty Seats</h1>

         <!-- <img src="img/intro/passenger.png" class="person translate" data-speed="-0.25" alt=""> -->
        <img src="img/intro/passenger.png" class="mountain1 translate" data-speed="-0.2" alt="">
        <img src="img/intro/grayback.png" class="mountain2 translate" data-speed="0.4" alt="">
        <img src="img/intro/buildings-taxi.png" class="mountain3 translate" data-speed="0.3" alt="">
      <!--  <img src="img/intro/parallax%20intro%20taxi.jpg" class="sky translate" data-speed="0.5" alt=""> -->
    </header>
    <!-- narrative section -->
     <section>
        <div class="shadow"></div>

        <div class="container-i">
            <div class="content opacity">
                <h3 class="title">
                    Introduction: Empty Taxi Trips
                    <div class="border"></div>
                </h3>
                <p class="text"><p>
        Chicago, Illinois is the third largest city in America, boasting a resident population totaling nearly three million people spread over 234 square miles. The city consistently ranks among the top 10 most visited cities in the country and has two international airports serving the city, allowing around 55 million tourists to visit annually. Such a large influx of people into the city generates a high demand for travel and requires an efficient system to get people where they need to go. Arguably, the city of Chicago’s most iconic means of transportation is, and remains, the taxi.
        <br><br>
       For a taxi company where efficiency is a necessity in maintaining profitability, understanding how to maximize their fleet’s cost of time is essential for successful business operations. Studying taxi trip data, made publicly available by the City of Chicago, we venture to explore taxi utilization, specifically empty trips, where taxis have no passengers. By analyzing empty trip data, or time spent off the clock, we can gain better insight as to the rhythms and patterns of Chicago's taxi services and make more educated decisions regarding transportation and city-wide mobility. 
       <br><br>
    

      </p>
            </div>

            <div class="imgContainer opacity">
                <img src="img/taxi-service-vector-F.jpg" alt="">
            </div>
        </div>
    </section>
        
<div class="container one-bottom">
    <h2><br><br>Observations + Findings <i class="fas fa-project-diagram"></i></h2>
    <h6>Our approach to work through the complexity of this condition was to first identify the empty taxi trips by analyzing the time spent between pickups and drop offs for each individual taxi in our dataset. This time was considered “idle tIme,” where taxis were not actively transporting passengers; this time ranges from time spent taking a break, to driving to another location, to taking time off of work. 
    </h6>
    <h6>After filtering our dataset and restructuring it through visual representation, we were able to observe clusters and peaks in our graphs, which led to some interesting findings. Using these visualizations, we are able to offer an educated speculation on how the average taxi driver in Chicago utilizes their time. Being able to better understand the dynamics of cost of time allow for increased profit amongst taxi companies Our visualizations display our data in two different graphic forms, which represents frequency of empty taxi trip time plotted throughout a 24 hour time period and also weekly. </h6>
</div>

<div class="container one_bottom">
    <img src="img/intro/ChicagoTaxi.jpg" alt="">
</div>



<div class="container one-bottom">
<h3><br><br> Stream Graph <i class="fas fa-chart-bar"></i></h3>
</div>
<div class="chart">
</div>

<div class="container one-bottom">
    <h6>In the streamgraphs it can be observed that there is a large variation in time of empty trips starting around 7 AM, then peaks around 6pm with the greatest amount of empty trim time amounting to less than 30 minutes on average. Since typical weekday weekdays start around this time in the morning, we can speculate that this peak shows us typical taxi traffic transportation patterns for morning commutes, whereby taxis are frequently picking up and dropping off customers.</h6>
    <h6>Another peak of increased frequency of empty trips occurs around the evening time at about 6 PM, which might indicate an end to the typical workday or a lull between the workday and evening leisure activities. </h6>
</div>

<div class="container one-bottom">
    <h3> Grouped Bar Chart <i class="fas fa-chart-bar"></i></h3>

    <svg id="svg" width="900" height="400"></svg>
    <br>

    Choose type:
    <select id="options"></select>

    <input type="checkbox" id="sort">
    Toggle sort

    <h6>In the grouped bar charts showing the frequency of empty trips throughout the week. We can observe two peaks, around the 40 hour mark and 64 hour mark, respectively. Interpreting the graph, these blocks of empty time represent time spent between the last passenger drop off to the next passenger pickup. From our dataset we can speculate that when taxi drivers choose to take one day off a week. They either choose Saturday or Sunday.</h6>

    <svg id="svg2" width="900" height="400"></svg>
    <br>

    Choose type:
    <select id="options2"></select>

    <input type="checkbox" id="sort2">
    Toggle sort

    <h6>Making an educated inference based on our findings, we speculate the second peak of empty trip time around 64 hours to be some taxi operators taking the entire weekend off from work, thus working Monday through Friday.
    </h6>

    <svg id="svg3" width="900" height="400"></svg>
    <br>

    Choose type:
    <select id="options3"></select>

    <input type="checkbox" id="sort3">
    Toggle sort

    <h6>We can also see peaks of shorter empty trips during the late evening and early morning hours on the weekends. This suggests a higher demand of taxis during this time of the day on the weekends only.
    </h6>

</div>

<div>
    <img class="twelve columns scale-with-grid quarter-bottom-rel" src="img/ChicagoTaxis.jpg">
</div>

<div class="container one-bottom">
    <h2>Conclusions and Moving Forward <i class="fas fa-project-diagram"></i></h2>
    <h6>After having analyzed our data set visually, we can draw conclusions based on our observations. The first finding is that there are two peaks of empty trim times throughout a 24 hour period: the morning and evening commutes, where taxis are frequently moving, yet remain half of the time. The second finding is that the majority of Chicago’s taxi drivers operate from Monday morning to Saturday morning, having taken the rest of the weekend off.</h6>
    <h6>Drawing conclusions from our findings, we can reason that reducing unoccupied taxi trip time presents an opportunity to reduce overall traffic congestion in Chicago, improve citywide mobility, and improve taxi driver profit by increasing their overall utilization. </h6>
    <h6>Furthermore, due to decreased taxi operation volume on weekends, it would be wise for the city of Chicago to study and potentially invest in additional supplemental modes of transportation during the periods when taxi companies are not operating as fully. Adjusting schedules to allow for additional public transportation might decrease overall traffic congestion on the days taxis are in reduced operations.</h6>
    <h6>While our visualizations provide us with the necessary information to observe these findings, a plausible next step would be to develop a simulation or model. This would allow us to examine specific variables that would benefit or challenge our assumptions. An example of such a simulation could be utilizing the idle time between pick up and drop off at each popular destination located in Chicago, in relation to taxi fare and taxi demand. Allowing us to look at the cost of idle time in respect to revenue loss or profit between these destinations, and find the optimal efficiency of taxi distribution throughout any given day.</h6>
</div>

<div class="container one-bottom" >
    <h2>Team & Contributions</h2>
    <h5>Davis Millarrd</h5>
    <h6>Helped outline the organization of the webpage, assisted Connor in primary interpretation of the visual graphical analysis’ resulting in our findings and observations, wrote and edited the narrative text displayed in each category (Introduction: Empty Taxi Trips, Observations + Findings, Conclusion + Moving Forward), and assisted in finding sourced images to use for overall web page aesthetic. Ensured the team kept pace with work deadlines.</h6>
    <h5>Connor Burdick</h5>
    <h6>Cleaned the data from our data source using Python. Created the streamgraphs and grouped bar charts using d3. Helped format webpage. Helped discuss narrative and findings from the graphs.</h6>
    <h5>Aaron Perrill</h5>
    <h6>Wrote and edited the website text specifically: “Introduction: Empty Taxi Trips”,  “Observations + Findings”, “Conclusion + Moving Forward”. Organized all virtual  team meetings and guided group discussions. Helped in acquiring images for website aesthetics. Helped in guiding the general and aesthetic organization of the website. </h6>
    <h5>Mohammad Fasahat</h5>
    <h6>Created a new GitHub repository to launch the webpage. Built the animation effect for the introduction of the webpage and designed the frame. Edited the HTML and CSS files. Helped by discussing and researching the narratives and graphs.</h6>
</div>



<script>


    chart("time_count.csv", "orange");
    chart("time_count_rest.csv", "orange");

    var datearray = [];
    var colorrange = [];


    function chart(csvpath, color) {

        if (color == "blue") {
            colorrange = ["#045A8D", "#2B8CBE", "#74A9CF", "#A6BDDB", "#D0D1E6", "#F1EEF6"];
        }
        else if (color == "pink") {
            colorrange = ["#980043", "#DD1C77", "#DF65B0", "#C994C7", "#D4B9DA", "#F1EEF6"];
        }
        else if (color == "orange") {
            colorrange = ["#B30000", "#E34A33", "#FC8D59", "#FDBB84", "#FDD49E", "#FEF0D9"];
        }
        strokecolor = colorrange[0];

        var format = d3v3.time.format("%H:%M:%S");

        var margin = {top: 50, right: 50, bottom: 50, left: 40};
        var width = document.body.clientWidth - margin.left - margin.right;
        var height = 400 - margin.top - margin.bottom;

        var tooltip = d3v3.select("body")
            .append("div")
            .attr("class", "remove")
            .style("position", "absolute")
            .style("z-index", "20")
            .style("visibility", "hidden")
            .style("top", "3070px")
            .style("left", "55px");

        var x = d3v3.time.scale()
            .range([0, width]);

        var y = d3v3.scale.linear()
            .range([height-10, 0]);

        var z = d3v3.scale.ordinal()
            .range(colorrange);

        var xAxis = d3v3.svg.axis()
            .scale(x)
            .orient("bottom")
            .ticks(d3v3.time.hours);

        var yAxis = d3v3.svg.axis()
            .scale(y);

        var yAxisr = d3v3.svg.axis()
            .scale(y);

        var stack = d3v3.layout.stack()
            .offset("silhouette")
            .values(function(d) { return d.values; })
            .x(function(d) { return d.date; })
            .y(function(d) { return d.value; });

        var nest = d3v3.nest()
            .key(function(d) { return d.key; });

        var area = d3v3.svg.area()
            .interpolate("cardinal")
            .x(function(d) { return x(d.date); })
            .y0(function(d) { return y(d.y0); })
            .y1(function(d) { return y(d.y0 + d.y); });

        var svg = d3v3.select(".chart").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var graph = d3v3.csv(csvpath, function(data) {
            data.forEach(function(d) {
                d.date = format.parse(d.date);
                d.value = +d.value;
            });

            var layers = stack(nest.entries(data));

            x.domain(d3v3.extent(data, function(d) { return d.date; }));
            y.domain([0, d3v3.max(data, function(d) { return d.y0 + d.y; })]);

            svg.selectAll(".layer")
                .data(layers)
                .enter().append("path")
                .attr("class", "layer")
                .attr("d", function(d) { return area(d.values); })
                .style("fill", function(d, i) { return z(i); });


            svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis);

            svg.append("g")
                .attr("class", "y axis")
                .attr("transform", "translate(" + width + ", 0)")
                .call(yAxis.orient("right"));

            svg.append("g")
                .attr("class", "y axis")
                .call(yAxis.orient("left"));

            svg.selectAll(".layer")
                .attr("opacity", 1)
                .on("mouseover", function(d, i) {
                    svg.selectAll(".layer").transition()
                        .duration(250)
                        .attr("opacity", function(d, j) {
                            return j != i ? 0.6 : 1;
                        })})

                .on("mousemove", function(d, i) {
                    mousex = d3v3.mouse(this);
                    mousex = mousex[0];
                    var invertedx = x.invert(mousex);
                    invertedx = invertedx.getHours();
                    var selected = (d.values);
                    for (var k = 0; k < selected.length; k++) {
                        datearray[k] = selected[k].date
                        datearray[k] = datearray[k].getHours();
                    }

                    mousedate = datearray.indexOf(invertedx);
                    pro = d.values[mousedate].value;

                    d3v3.select(this)
                        .classed("hover", true)
                        .attr("stroke", strokecolor)
                        .attr("stroke-width", "0.5px"),
                        tooltip.html( "<p>" + d.key + "<br>" + pro + "</p>" ).style("visibility", "visible");

                })
                .on("mouseout", function(d, i) {
                    svg.selectAll(".layer")
                        .transition()
                        .duration(250)
                        .attr("opacity", "1");
                    d3v3.select(this)
                        .classed("hover", false)
                        .attr("stroke-width", "0px"), tooltip.html( "<p>" + d.key + "<br>" + pro + "</p>" ).style("visibility", "hidden");
                })

            var vertical = d3v3.select(".chart")
                .append("div")
                .attr("class", "remove")
                .style("position", "absolute")
                .style("z-index", "19")
                .style("width", "1px")
                .style("height", "380px")
                .style("top", "10px")
                .style("bottom", "30px")
                .style("left", "0px")
                .style("background", "#fff");

            d3v3.select(".chart")
                .on("mousemove", function(){
                    mousex = d3v3.mouse(this);
                    mousex = mousex[0] + 5;
                    vertical.style("left", mousex + "px" )})
                .on("mouseover", function(){
                    mousex = d3v3.mouse(this);
                    mousex = mousex[0] + 5;
                    vertical.style("left", mousex + "px")});
        });
    }


</script>

<script src="bar1.js"></script>
<script src="bar2.js"></script>
<script src="bar3.js"></script>
<script src="js/app.js"></script>


</body>
</html>