<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Basic Page Needs–– -->
    <meta charset="utf-8">
    <title>Full Streets Empty Seats</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- FONT -->
    <link href="https://fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css">

    <!-- CSS -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/customize.css">

    <!-- D3 -->
    <script src="https://d3js.org/d3.v3.js"></script>
    <script type="text/javascript">
        var d3v3 = window.d3;
        window.d3 = null;
    </script>
    <script src="https://d3js.org/d3.v5.js"></script>

</head>

<style>

    body {
        font: 10px sans-serif;
    }

    .chart {
        background: #fff;
    }

    p {
        font: 12px helvetica;
    }


    .axis path, .axis line {
        fill: none;
        stroke: #000;
        stroke-width: 2px;
        shape-rendering: crispEdges;
    }

    button {
        position: absolute;
        right: 50px;
        top: 10px;
    }

</style>

<body> 
       <div class="container one-bottom" style="margin-top: 50px">
    <div class="ten columns">
      <h2>Full Streets, Empty Seats</h2>
      <p>
       Mobility on Demand Systems: Data-Driven Analysis, Simulation, Visualization
       <br>
        ARCH 6306/6050, DSBA 6010, ITIS 8010/6010: Wednesdays 6pm-8:30pm, Taught Online
        <br>
        Team: Davis Millarrd, Connor Burdick, Aaron Perrill, Mohammad Fasahat
        <br>
        Dr. Dimitris Papanikolaou | dpapanik@uncc.edu | Urban Synergetics Lab | https://urbansynergeticslab.net
      </p>
    </div>
    <div class="two columns">
      <a href="https://urbansynergeticslab.net/"><img class="scale-with-grid" src="img/LabLogo_dark_cropped.png"></a>
    </div>
    
  </div>
<div>
    <img class="twelve columns scale-with-grid quarter-bottom-rel" src="img/intro4.jpg">
</div>
<!-- <div class="container one_bottom">
    <img src="img/intro1.jpg" alt="">
</div> -->

<div class="container one-bottom">
    <h2>Introduction: Empty Taxi Trips</h2>
    <h6>Chicago, Illinois is the third largest city in America, boasting a resident population totaling nearly three million people spread over 234 square miles. The city consistently ranks among the top 10 most visited cities in the country and has not one, but two international airports serving the city, allowing for around 55 million tourists to visit Chicago annually. With such a large influx of people every year due to business and tourism, along with the people of Chicago who already call the city home, there is a  constant demand for highly efficient modes of transportation into and around the city. Arguably, the city of Chicago’s most iconic and versatile means of transportation is, and remains, the Taxi.
    </h6>
    <h6>For a taxi company where efficiency is a necessity in maintaining profitability, understanding how to maximize their fleet’s cost of time is essential for successful business operations. Studying taxi trip data, made publicly available by the City of Chicago, we venture to explore taxi utilization, specifically empty trips, where taxis have no passengers. By analyzing empty trip data, or time spent off the clock, we can gain better insight as to the rhythms and patterns of Chicago's taxi services and make more educated decisions regarding transportation and city-wide mobility. </h6>
</div>

<div class="container one_bottom">
    <img src="img/intro/ChicagoTaxi.jpg" alt="">
    <p>https://www.absolute-taxi.com/blog/8-etiquette-rules-when-using-a-taxi-service-in-new-york</p>
</div>

<div class="container one-bottom">
   <br><br> <h2>Observation and Findings <i class="fas fa-project-diagram"></i></h2>
    <h6>Our approach to work through the complexity of this condition was to first identify the empty taxi trips by analyzing the time spent between pickups and drop offs for each individual taxi in our dataset. This time was considered “idle tIme,” where taxis were not actively transporting passengers; this time ranges from time spent taking a break, to driving to another location, to taking time off of work. </h6>
    <h6>After filtering our dataset and restructuring it through visual representation, we were able to observe clusters and peaks in our graphs, which led to some interesting findings. Using these visualizations, we are able to offer an educated speculation on how the average taxi driver in Chicago utilizes their time. Being able to better understand the dynamics of cost of time allow for increased profit amongst taxi companies
        Our visualizations display our data in two different graphic forms, which represents frequency of empty taxi trip time plotted throughout a 24 hour time period and also weekly.
    </h6>
</div>

<div class="container one-bottom">
<h3> Analysing the number of idle trips during a 24-hour period <i class="fas fa-chart-bar"></i></h3>

</div>
<div class="chart">
</div>

<div class="container one-bottom">
    <h6>In the streamgraphs it can be observed that there is a large variation in time of empty trips starting around 7 AM, then peaks around 6pm with the greatest amount of empty trim time amounting to less than 30 minutes on average. Since typical weekday weekdays start around this time in the morning, we can speculate that this peak shows us typical taxi traffic transportation patterns for morning commutes, whereby taxis are frequently picking up and dropping off customers.</h6>
    <h6>Another peak of increased frequency of empty trips occurs around the evening time at about 6 PM, which might indicate an end to the typical workday or a lull between the workday and evening leisure activities. </h6>
</div>

<div class="container one-bottom">
    <h3> Analyzing idle trips over a weekly period <i class="fas fa-chart-bar"></i></h3>
    

    <svg id="svg" width="900" height="400"></svg>
    <br>

    Choose time:
    <select id="options"></select>

    <input type="checkbox" id="sort">
    Toggle sort

    <h6>In the grouped bar charts showing the frequency of empty trips throughout the week. We can observe two peaks, around the 40 hour mark and 64 hour mark, respectively. Interpreting the graph, these blocks of empty time represent time spent between the last passenger drop off to the next passenger pickup. From our dataset we can speculate that when taxi drivers choose to take one day off a week. They either choose Saturday or Sunday.</h6>

    <svg id="svg3" width="900" height="400"></svg>
    <br>

    Choose time:
    <select id="options3"></select>

    <input type="checkbox" id="sort3">
    Toggle sort

    <h6>Making an educated inference based on our findings, we speculate the second peak of empty trip time around 64 hours to be some taxi operators taking the entire weekend off from work, thus working Monday through Friday.
    </h6>

    <svg id="svg2" width="900" height="400"></svg>
    <br>

    Choose time:
    <select id="options2"></select>

    <input type="checkbox" id="sort2">
    Toggle sort

    <h6>We can also see peaks of shorter empty trips during the late evening and early morning hours on the weekends. This suggests a higher demand of taxis during this time of the day on the weekends only.
    </h6>

</div>

<div>
    <img class="twelve columns scale-with-grid quarter-bottom-rel" src="img/ChicagoTaxis.jpg">
    <p>https://chicagodefender.com/city-of-chicago-provides-financial-relief-for-transportation-during-states-stay-at-home-order/</p>
</div>

<div class="container one-bottom">
    <h2>Conclusions and Moving Forward <i class="fas fa-project-diagram"></i></h2>
    <h6>The research discussed in this paper sought to further analyze and understand the complexities behind taxi operations in a large metropolitan city. Using publically available data from the City of Chicago, our team analyzed lengths of idle taxi trips, where operators had no passengers. Through the use of computational analysis paired with data visualizations, our team was able to gain interesting insights into the weekly operations of Chicago’s taxi system. 
</h6>
    <h6>From our visualizations, we were able to observe accumulations of idle trip lengths plotted across a week. We found that there are two peaks of these idle trip accumulations that occur at the beginning and end of the work day, 7 AM, and 6 PM respectively. It is plausible the reason for these increased accumulations of idle trip lengths might have to do with traffic congestion occurring during these peak traffic hours and drivers not being able to travel efficiently. Looking again at the streamgraph, an additional accumulation of idle trip lengths occurs around hour 40 and 64 out of a 168 hour work week (starting on Sunday). These blocks of idle trips occurring over the weekends represent time spent between the last passenger drop off to the next passenger pickup. From our dataset we can speculate that when taxi drivers choose to take one day off a week. They either choose Saturday or Sunday. </h6>

    <h6>Our research has led us to a better understanding of Chicago’s taxi operations. Expanding on this research, it would be interesting to see how these idle trip times could be expressed in terms of cost of time and missed opportunities to analyze what economic impacts idle trips have on a taxi company’s revenue. Assuming the lengths of idle trips could be converted into monetary terms (time, fuel spent, overhead, driver’s wages, wasted opportunities, etc.) economic costs would become clear, and solutions for reducing wasted idle time would likely become a priority for profit-driven taxi companies. 
</h6>
</div>

<div class="container one-bottom" >
    <h2>Team & Contributions</h2>
    <h5>Davis Millarrd</h5>
    <h6>Helped outline the organization of the webpage, assisted Connor in primary interpretation of the visual graphical analysis’ resulting in our findings and observations, wrote and edited the narrative text displayed in each category (Introduction: Empty Taxi Trips, Observations + Findings, Conclusion + Moving Forward), and assisted in finding sourced images to use for overall web page aesthetic. Ensured the team kept pace with work deadlines.</h6>
    <h5>Connor Burdick</h5>
    <h6>Cleaned the data from our data source using Python. Created the streamgraphs and grouped bar charts using d3. Helped format webpage. Helped discuss narrative and findings from the graphs.</h6>
    <h5>Aaron Perrill</h5>
    <h6>Wrote and edited the website text specifically: “Introduction: Empty Taxi Trips”,  “Observations + Findings”, “Conclusion + Moving Forward”. Organized all virtual  team meetings and guided group discussions. Helped in acquiring images for website aesthetics. Helped in guiding the general and aesthetic organization of the website. </h6>
    <h5>Mohammad Fasahat</h5>
    <h6>Created a new GitHub repository to launch the webpage. Built the animation effect for the introduction of the webpage and designed the frame. Edited the HTML and CSS files. Helped by discussing and researching the narratives and graphs.</h6>
</div>



<script>


    chart("time_count.csv", "orange");
    chart("time_count_rest.csv", "orange");

    var datearray = [];
    var colorrange = [];


    function chart(csvpath, color) {

        if (color == "blue") {
            colorrange = ["#045A8D", "#2B8CBE", "#74A9CF", "#A6BDDB", "#D0D1E6", "#F1EEF6"];
        }
        else if (color == "pink") {
            colorrange = ["#980043", "#DD1C77", "#DF65B0", "#C994C7", "#D4B9DA", "#F1EEF6"];
        }
        else if (color == "orange") {
            colorrange = ["#B30000", "#E34A33", "#FC8D59", "#FDBB84", "#FDD49E", "#FEF0D9"];
        }
        strokecolor = colorrange[0];

        var format = d3v3.time.format("%H:%M:%S");

        var margin = {top: 50, right: 50, bottom: 50, left: 40};
        var width = document.body.clientWidth - margin.left - margin.right;
        var height = 400 - margin.top - margin.bottom;

        var tooltip = d3v3.select("body")
            .append("div")
            .attr("class", "remove")
            .style("position", "absolute")
            .style("z-index", "20")
            .style("visibility", "hidden")
            .style("top", "2890px")
            .style("left", "55px");

        var x = d3v3.time.scale()
            .range([0, width]);

        var y = d3v3.scale.linear()
            .range([height-10, 0]);

        var z = d3v3.scale.ordinal()
            .range(colorrange);

        var xAxis = d3v3.svg.axis()
            .scale(x)
            .orient("bottom")
            .ticks(d3v3.time.hours);

        var yAxis = d3v3.svg.axis()
            .scale(y);

        var yAxisr = d3v3.svg.axis()
            .scale(y);

        var stack = d3v3.layout.stack()
            .offset("silhouette")
            .values(function(d) { return d.values; })
            .x(function(d) { return d.date; })
            .y(function(d) { return d.value; });

        var nest = d3v3.nest()
            .key(function(d) { return d.key; });

        var area = d3v3.svg.area()
            .interpolate("cardinal")
            .x(function(d) { return x(d.date); })
            .y0(function(d) { return y(d.y0); })
            .y1(function(d) { return y(d.y0 + d.y); });

        var svg = d3v3.select(".chart").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var graph = d3v3.csv(csvpath, function(data) {
            data.forEach(function(d) {
                d.date = format.parse(d.date);
                d.value = +d.value;
            });

            var layers = stack(nest.entries(data));

            x.domain(d3v3.extent(data, function(d) { return d.date; }));
            y.domain([0, d3v3.max(data, function(d) { return d.y0 + d.y; })]);

            svg.selectAll(".layer")
                .data(layers)
                .enter().append("path")
                .attr("class", "layer")
                .attr("d", function(d) { return area(d.values); })
                .style("fill", function(d, i) { return z(i); });


            svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis);

            svg.append("text")
                .attr("class", "x label")
                .attr("text-anchor", "end")
                .attr("x", width - 30)
                .attr("y", height - 6)
                .text("Time of the Day (hour)    ");

            svg.append("g")
                .attr("class", "y axis")
                .attr("transform", "translate(" + width + ", 0)")
                .call(yAxis.orient("right"));

            svg.append("g")
                .attr("class", "y axis")
                .call(yAxis.orient("left"));

            svg.append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 20 - margin.left)
                .attr("x",175 - (height / 2))
                .attr("dy", "1em")
                .style("text-anchor", "middle")
                .text("Frequency");

            svg.selectAll(".layer")
                .attr("opacity", 1)
                .on("mouseover", function(d, i) {
                    svg.selectAll(".layer").transition()
                        .duration(250)
                        .attr("opacity", function(d, j) {
                            return j != i ? 0.6 : 1;
                        })})

                .on("mousemove", function(d, i) {
                    mousex = d3v3.mouse(this);
                    mousex = mousex[0];
                    var invertedx = x.invert(mousex);
                    invertedx = invertedx.getHours();
                    var selected = (d.values);
                    for (var k = 0; k < selected.length; k++) {
                        datearray[k] = selected[k].date
                        datearray[k] = datearray[k].getHours();
                    }

                    mousedate = datearray.indexOf(invertedx);
                    pro = d.values[mousedate].value;

                    d3v3.select(this)
                        .classed("hover", true)
                        .attr("stroke", strokecolor)
                        .attr("stroke-width", "0.5px"),
                        tooltip.html( "<p>" + "Empty Trip Duration:   " + d.key + "  hours" + "<br>" + "Frequency:   " + pro  + "</p>" ).style("visibility", "visible");

                })
                .on("mouseout", function(d, i) {
                    svg.selectAll(".layer")
                        .transition()
                        .duration(250)
                        .attr("opacity", "1");
                    d3v3.select(this)
                        .classed("hover", false)
                        .attr("stroke-width", "0px"), tooltip.html( "<p>" + d.key + "<br>" + pro + "</p>" ).style("visibility", "hidden");
                })

            var vertical = d3v3.select(".chart")
                .append("div")
                .attr("class", "remove")
                .style("position", "absolute")
                .style("z-index", "19")
                .style("width", "1px")
                .style("height", "380px")
                .style("top", "10px")
                .style("bottom", "30px")
                .style("left", "0px")
                .style("background", "#fff");

            d3v3.select(".chart")
                .on("mousemove", function(){
                    mousex = d3v3.mouse(this);
                    mousex = mousex[0] + 5;
                    vertical.style("left", mousex + "px" )})
                .on("mouseover", function(){
                    mousex = d3v3.mouse(this);
                    mousex = mousex[0] + 5;
                    vertical.style("left", mousex + "px")});
        });
    }


</script>

<script src="bar1.js"></script>
<script src="bar2.js"></script>
<script src="bar3.js"></script>

</body>
</html>